<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>WHITE_BOX Terminal</title>
  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body {
      background-color: #000;
      color: #0f0;
      font-family: 'Source Code Pro', monospace;
      margin: 0;
      padding: 0;
      overflow: hidden;
    }

    .min-h-screen {
      display: flex;
      height: 100vh;
      background: url('matrix-bg.gif') no-repeat center center fixed;
      background-size: cover;
    }

    .menu {
      overflow-y: auto;
      width: 250px;
      background-color: rgba(0, 0, 0, 0.8);
      padding: 20px;
      border-right: 2px solid #0f0;
    }

    .menu::-webkit-scrollbar {
      display: none;
    }

    .menu-header {
      color: #0f0;
      font-size: 1.2em;
      margin-bottom: 20px;
      text-align: center;
      text-transform: uppercase;
    }

    .category-button,
    .back-button {
      display: block;
      width: 100%;
      padding: 10px;
      margin-bottom: 10px;
      background-color: #111;
      color: #0f0;
      border: 1px solid #0f0;
      font-family: 'Source Code Pro', monospace;
      cursor: pointer;
      transition: background-color 0.3s, color 0.3s;
    }

    .category-button:hover,
    .back-button:hover {
      background-color: #0f0;
      color: #000;
    }

    .terminal-window {
      flex: 1;
      background-color: rgba(0, 0, 0, 0.8);
      margin: 20px;
      border: 2px solid #0f0;
      box-shadow: 0 0 10px #0f0;
      position: relative; /* Added for score positioning */
    }

    .terminal-header {
      padding: 10px;
      background-color: #111;
      border-bottom: 2px solid #0f0;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .terminal-title {
      color: #0f0;
      font-size: 1.2em;
    }

    .terminal-controls button {
      background: none;
      border: none;
      color: #0f0;
      cursor: pointer;
      margin-left: 10px;
    }

    .terminal-content {
      padding: 20px;
      height: calc(100% - 60px);
      overflow-y: auto;
    }

    .input-field {
      width: 100%;
      height: 100px;
      background-color: #111;
      color: #0f0;
      border: 1px solid #0f0;
      padding: 10px;
      font-family: 'Source Code Pro', monospace;
      resize: none;
    }

    .valid-button {
      margin-top: 10px;
      padding: 10px 20px;
      background-color: #0f0;
      color: #000;
      border: none;
      cursor: pointer;
      font-family: 'Source Code Pro', monospace;
      transition: background-color 0.3s;
    }

    .valid-button:hover {
      background-color: #0c0;
    }

    .score {
      position: absolute;
      bottom: 10px;
      right: 10px;
      color: #0f0;
      font-size: 1em;
    }

    @keyframes blink {
      0% {
        opacity: 1;
      }
      50% {
        opacity: 0;
      }
      100% {
        opacity: 1;
      }
    }

    .cursor {
      display: inline-block;
      width: 10px;
      height: 20px;
      background-color: #0f0;
      animation: blink 1s infinite;
    }
  </style>
</head>

<body>
  <div class="min-h-screen">
    <div class="menu">
      <button class="back-button" onclick="window.location.href='../boxs.html'">Back to Dashboard</button>
      <div class="menu-header">Penetration Testing Categories</div>
      <button class="category-button" onclick="showCategory('information-gathering')">Information Gathering</button>
      <button class="category-button" onclick="showCategory('static-code-analysis')">Static Code Analysis</button>
      <button class="category-button" onclick="showCategory('dynamic-analysis')">Dynamic Analysis</button>
      <button class="category-button" onclick="showCategory('privilege-escalation-testing')">Privilege Escalation Testing</button>
      <button class="category-button" onclick="showCategory('exploit-development')">Exploit Development</button>
      <button class="category-button" onclick="showCategory('manual-code-review')">Manual Code Review</button>
      <button class="category-button" onclick="showCategory('security-vulnerabilities-testing')">Test for Security Vulnerabilities (SQLi, XSS, CSRF, etc.)</button>
      <button class="category-button" onclick="showCategory('access-control-testing')">Access Control Testing</button>
      <button class="category-button" onclick="showCategory('authentication-session-testing')">Authentication and Session Management Testing</button>
      <button class="category-button" onclick="showCategory('privilege-role-management-testing')">Privilege and Role Management Testing</button>
      <button class="category-button" onclick="showCategory('fuzz-testing')">Fuzz Testing</button>
      <button class="category-button" onclick="showCategory('security-misconfiguration-testing')">Security Misconfiguration Testing</button>
      <button class="category-button" onclick="showCategory('code-coverage-unit-testing')">Code Coverage and Unit Testing</button>
      <button class="category-button" onclick="showCategory('exploitation-reporting')">Exploitation & Reporting</button>
    </div>

    <div class="terminal-window">
      <div class="terminal-header">
        <div class="flex items-center">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2">
            <polyline points="4 17 10 11 4 5"></polyline>
            <line x1="12" y1="19" x2="20" y2="19"></line>
          </svg>
          <div class="terminal-title">WHITE_BOX TERMINAL v1.0</div>
        </div>
        <div class="terminal-controls">
          <button><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <line x1="5" y1="12" x2="19" y2="12"></line>
            </svg></button>
          <button><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <polyline points="15 3 21 3 21 9"></polyline>
              <polyline points="9 21 3 21 3 15"></polyline>
              <line x1="21" y1="3" x2="14" y2="10"></line>
              <line x1="3" y1="21" x2="10" y2="14"></line>
            </svg></button>
          <button><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg></button>
        </div>
      </div>

      <div class="terminal-content" id="terminal-content">
        <!-- Initial content: Hello World -->
        <div>
          <p>‚ö™ <strong>White Box Testing (Full Access)</strong><br>
            üîπ <strong>Pentester Knowledge:</strong> ‚úÖ Full access to source code, architecture, and credentials.<br>
            üîπ <strong>Approach:</strong> Simulates a developer/security analyst review of the system.<br>
            üîπ <strong>Methods:</strong> Code review, debugging, in-depth testing, security misconfigurations.<br>
            üîπ <strong>Challenges:</strong> Time-consuming, requires expertise in code auditing.<br>
            üîπ <strong>Tools:</strong> Static/Dynamic Analysis (SAST/DAST), SonarQube, Checkmarx, Fortify.<br>
            üí° <strong>Best For:</strong> DevSecOps, secure coding reviews, and deep vulnerability discovery.<br>
            üë®‚Äçüíª üõ†Ô∏è üîß üñ•Ô∏è
          </p>
          <button class="valid-button">Valid</button>
          <a href="data:text/plain;charset=utf-8,test file content here" download="test.txt">
            <button class="valid-button">Download Source Code</button>
          </a>
        </div>
      </div>
      <div class="score" id="scoreDisplay">Score: 0%</div> <!-- Score display in bottom right -->
    </div>
  </div>

  <script>
    let currentCategory = null;
    let validTerms = {};
    let totalScore = 0; // Global variable to track cumulative score
  
    // Fetch valid_terms.txt and parse it
    async function loadValidTerms() {
      try {
        const response = await fetch('valid_terms.txt', { cache: 'no-cache' });
        if (!response.ok) throw new Error('File not found');
        const text = await response.text();
        const lines = text.split('\n');
        validTerms = {};
  
        lines.forEach(line => {
          if (line.trim() && !line.startsWith('#')) {
            const [category, terms] = line.split(':');
            if (category && terms) {
              validTerms[category.trim()] = terms.split(',').map(term => term.trim().toLowerCase());
            }
          }
        });
        console.log('Loaded validTerms:', validTerms); // Debug log
      } catch (error) {
        console.error('Error loading valid_terms.txt:', error);
        alert('Failed to load valid terms. Ensure valid_terms.txt exists and the server is running.');
      }
    }
  
    // Show category content and set up input
    function showCategory(category) {
      // Map the category ID to the human-readable name used in valid_terms.txt
      const categoryMap = {
        'information-gathering': 'Information Gathering',
        'static-code-analysis': 'Static Code Analysis',
        'dynamic-analysis': 'Dynamic Analysis',
        'privilege-escalation-testing': 'Privilege Escalation Testing',
        'exploit-development': 'Exploit Development',
        'manual-code-review': 'Manual Code Review',
        'security-vulnerabilities-testing': 'Test for Security Vulnerabilities (SQLi, XSS, CSRF, etc.)',
        'access-control-testing': 'Access Control Testing',
        'authentication-session-testing': 'Authentication and Session Management Testing',
        'privilege-role-management-testing': 'Privilege and Role Management Testing',
        'fuzz-testing': 'Fuzz Testing',
        'security-misconfiguration-testing': 'Security Misconfiguration Testing',
        'code-coverage-unit-testing': 'Code Coverage and Unit Testing',
        'exploitation-reporting': 'Exploitation & Reporting'
      };
      
      currentCategory = categoryMap[category] || null;
      console.log('Current Category:', currentCategory);
  
      const content = {
        'information-gathering': 'You selected Information Gathering. Type your command below...',
        'static-code-analysis': 'You selected Static Code Analysis. Type your command below...',
        'dynamic-analysis': 'You selected Dynamic Analysis. Type your command below...',
        'privilege-escalation-testing': 'You selected Privilege Escalation Testing. Type your command below...',
        'exploit-development': 'You selected Exploit Development. Type your command below...',
        'manual-code-review': 'You selected Manual Code Review. Type your command below...',
        'security-vulnerabilities-testing': 'You selected Test for Security Vulnerabilities (SQLi, XSS, CSRF, etc.). Type your command below...',
        'access-control-testing': 'You selected Access Control Testing. Type your command below...',
        'authentication-session-testing': 'You selected Authentication and Session Management Testing. Type your command below...',
        'privilege-role-management-testing': 'You selected Privilege and Role Management Testing. Type your command below...',
        'fuzz-testing': 'You selected Fuzz Testing. Type your command below...',
        'security-misconfiguration-testing': 'You selected Security Misconfiguration Testing. Type your command below...',
        'code-coverage-unit-testing': 'You selected Code Coverage and Unit Testing. Type your command below...',
        'exploitation-reporting': 'You selected Exploitation & Reporting. Type your command below...'
      };
  
      const savedText = localStorage.getItem(`terminalInput_${category}`) || '';
  
      document.getElementById('terminal-content').innerHTML = `
        <div>
          <textarea id="userInput" class="input-field" placeholder="${content[category]}">${savedText}</textarea>
          <button class="valid-button" onclick="validateInput()">Valid</button>
          <button class="valid-button" onclick="showHelloWorld()">Back</button>
          <span class="cursor"></span>
        </div>
      `;
  
      const input = document.getElementById("userInput");
      input.addEventListener("input", function () {
        localStorage.setItem(`terminalInput_${category}`, input.value);
      });
    }
  
    // Return to the "Hello World" message
    function showHelloWorld() {
      currentCategory = null;
      totalScore = 0; // Reset cumulative score
      document.getElementById('terminal-content').innerHTML = `
        <div>
          <p>‚ö™ <strong>White Box Testing (Full Access)</strong><br>
            üîπ <strong>Pentester Knowledge:</strong> ‚úÖ Full access to source code, architecture, and credentials.<br>
            üîπ <strong>Approach:</strong> Simulates a developer/security analyst review of the system.<br>
            üîπ <strong>Methods:</strong> Code review, debugging, in-depth testing, security misconfigurations.<br>
            üîπ <strong>Challenges:</strong> Time-consuming, requires expertise in code auditing.<br>
            üîπ <strong>Tools:</strong> Static/Dynamic Analysis (SAST/DAST), SonarQube, Checkmarx, Fortify.<br>
            üí° <strong>Best For:</strong> DevSecOps, secure coding reviews, and deep vulnerability discovery.<br>
            üë®‚Äçüíª üõ†Ô∏è üîß üñ•Ô∏è
          </p>
          <button class="valid-button">Valid</button>
          <a href="data:text/plain;charset=utf-8,test file content here" download="test.txt">
            <button class="valid-button">Download Source Code</button>
          </a>
        </div>
      `;
      document.getElementById('scoreDisplay').textContent = 'Score: 0%';
    }
  
    // Validate input and update score
    function validateInput() {
      if (!currentCategory) {
        alert('Please select a category first!');
        return;
      }
  
      const input = document.getElementById('userInput').value.trim().toLowerCase();
      const validList = validTerms[currentCategory] || [];
      let matchCount = 0;
  
      // Count how many terms from validList appear in the input
      validList.forEach(term => {
        if (input.includes(term)) {
          matchCount++;
        }
      });
  
      console.log('Input:', input, 'Valid List:', validList, 'Matches:', matchCount);
  
      // Accumulate score: 10% per match, capped at 100%
      totalScore = Math.min(totalScore + (matchCount * 10), 100);
  
      document.getElementById('scoreDisplay').textContent = `Score: ${totalScore}%`;
      document.getElementById('userInput').value = ''; // Clear input
    }
  
    // Load valid terms when the page loads
    window.onload = function() {
      loadValidTerms();
    };
  </script>
</body>
</html>